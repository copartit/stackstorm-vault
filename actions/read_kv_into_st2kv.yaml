---
name: read_kv_into_st2kv
runner_type: python-script
description: >-
  Read a kv value from Vault server and copy it (encrypted) to ST2 datastore.
  In workflows, use <% st2kv(system.<st2kv_key>, decrypt=>true) %> to retrieve it safely.
enabled: true
entry_point: read_kv_into_st2kv.py
parameters:
  st2kv_key:
    required: True
    type: string
    position: 0
  st2kv_ttl:
    type: integer
    description: "Optional TTL for the value in the ST2 Datastore"
    required: False
    position: 1
  path:
    type: string
    description: "Key to read from Vault"
    required: true
    position: 2
  kv_version:
    type: number
    description: "The version of the KV store in vault.  Use 1 for legacy kv stores, 2 for newer kv stores"
    required: true
    position: 3
  mount_point:
    type: string
    description: "The mount point of the kv store"
    required: true
    default: "secret"
    position: 4
  version:
    type: string
    description: "The version of the kv *data*"
    required: true
    default: '1'
    position: 5
  profile:
    type: string
    description: "Name of connection profile (in pack config) to use to connect to vault. Default profile defined in pack config."
    required: false
